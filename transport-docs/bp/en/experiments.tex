\chapter{Experimental evaluation}

In this chapter, we will describe and run experiments
that compare our planners from the last two chapters
with state-of-the-art domain-independent planners from the IPC.
We will briefly discuss the acquired results and interpret them.

\section{Methodology}

Using our benchmarking software (described in the attachments), we will now run experiments in an
environment as similar to the original
IPC as possible, following almost all of their rules mentioned in.\footnote{\url{http://icaps-conference.org/ipc2008/deterministic/CompetitionRules.html}}
We will run all tests according to principles mimicking the rules;
All planners have to be single-threaded and use a maximum of 2GB of memory, with a maximum run time of 30 minutes (planners will
get canceled and prompted for a plan at that time point).
Our planners explicitly and intentionally break the ``domain-independence'' rule of the IPC.

The evaluation criteria remain the same:
we focus on plan \textit{quality} in favor of planner run time,
although we will mention the times.
The quality of a plan for a specific planner and sequential problem $p$ is defined as
$$\frac{\mt{total-cost}(\mt{planner}(p))}{\mt{total-cost}(BEST)},$$
where the results called $BEST$
are either precalculated outside of the competition environment or they are the best result of one of the planners in the competition, depending on which plan has a lower total cost.
Quality is, therefore, a number between $0$ and $1$.
Note that we will use the original competition's best scores,
which means that the quality of our plans
might sometimes exceed the value of 1
(when our planners find a plan better than all the others found during the competition).
The overall goal for planners is to maximize the sum of qualities over the problem instances in a given dataset, called the \textit{total quality}.
For temporal domains, quality is calculated in the same way, just by substituting total cost
for total time. We sometimes refer to total cost and total time as the \textit{score} of the planner, a term that is not dependent on the domain variant.

We will use three datasets for our experiments --- the seq-sat-6
and seq-sat-8 datasets for sequential
and the tempo-sat-6 for temporal planners (Section~\ref{datasets}).
All the datasets used (and more) are available in the
software project sources, see the \nameref{cd-contents}.
Descriptions of planners referenced from now on by their names in the respective competitions can be found for both IPC~2008\footnote{\url{http://icaps-conference.org/ipc2008/deterministic/Planners.html}} and IPC~2014 \citep{Vallati2015}.

In all planners where nondeterminism occurs,
we set the initial random seed to 2017
on all individual runs.
All the following experiments
were run on a computer
containing an 8 core 64-bit processor \texttt{Intel(R) Core(TM) i7-6700 CPU @ 3.40GHz}
with 16 GB of memory, running Gentoo Linux.
A big thank you goes out to the faculty for providing us with unfettered access to these machines.
We run all Java programs on Oracle's OpenJDK 
version \texttt{1.8.0\_121}, build \texttt{b13}.
The results presented here were obtained with the \TEver{} version of the TransportEditor project.\footnote{Git tag \TEtag{}, available at \url{https://github.com/oskopek/TransportEditor}} The \texttt{NOTICE.txt} files
in the project module directories specify
the exact versions of libraries used.



















\section{Sequential Transport}

In this section, we present the results of our sequential planners on the seq-sat-6 and seq-sat-8 datasets. Specifically, these planners are included in the experiment:
\begin{description}
\item[SFA*A] The SFA* algorithm with heuristic A. \TODO{ref}
\item[SFA*B] The SFA* algorithm with heuristic B. \TODO{ref}
\item[SFAA*] The adjusting A* algorithm with heuristic X. \TODO{ref}
\item[OPS] The OptaPlanner sequential algorithm. \TODO{ref}
\end{description}

\subsection{Results}\label{sequential-results}

We show the IPC quality table
for the experimental run on the seq-sat-6 dataset (Table~\ref{tab:seq-sat-6-ipc-scores}),
the seq-sat-7 dataset (Table~\ref{tab:seq-sat-7-ipc-scores}),
and the seq-sat-8 dataset (Table~\ref{tab:seq-sat-8-ipc-scores}).
Additionally, a plot of the scores and run times is presented in Figures~\ref{fig:seq-sat-6-plots},
\ref{fig:seq-sat-7-plots}, and~\ref{fig:seq-sat-8-plots}. Details about the specific plans along with the benchmark results can be found in the \nameref{cd-contents}.

\begin{figure}
\centering
\begin{subtable}{\textwidth}
\centering
\input{../data/seq-sat-6-ipc-scores}
\caption{Quality and score of sequential planners on the seq-sat-6 dataset.}
\label{tab:seq-sat-6-ipc-scores}
\end{subtable}
\quad
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/seq-sat-6-quality}
\caption{Quality plot of sequential planners on the seq-sat-6 dataset.}
\label{fig:seq-sat-6-quality}
\end{subfigure}
\caption{Planner results on seq-sat-6.}
\label{fig:seq-sat-6-results}
\end{figure}

\begin{figure}
\centering
\begin{subtable}{\textwidth}
\centering
\input{../data/seq-sat-7-ipc-scores}
\caption{Quality and score of sequential planners on the seq-sat-7 dataset.}
\label{tab:seq-sat-7-ipc-scores}
\end{subtable}
\quad
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/seq-sat-7-quality}
\caption{Quality plot of sequential planners on the seq-sat-7 dataset.}
\label{fig:seq-sat-7-quality}
\end{subfigure}
\caption{Planner results on seq-sat-7.}
\label{fig:seq-sat-7-results}
\end{figure}

\begin{figure}
\centering
\begin{subtable}{\textwidth}
\centering
\input{../data/seq-sat-8-ipc-scores}
\caption{Quality and score of sequential planners on the seq-sat-8 dataset.}
\label{tab:seq-sat-8-ipc-scores}
\end{subtable}
\quad
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/seq-sat-8-quality}
\caption{Quality plot of sequential planners on the seq-sat-8 dataset.}
\label{fig:seq-sat-8-quality}
\end{subfigure}
\caption{Planner results on seq-sat-8.}
\label{fig:seq-sat-8-results}
\end{figure}

\begin{figure}
\centering
\begin{subtable}{\textwidth}
\centering
\input{../data/tempo-sat-6-ipc-scores}
\caption{Quality and score of sequential planners on the tempo-sat-6 dataset.}
\label{tab:tempo-sat-6-ipc-scores}
\end{subtable}
\quad
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/tempo-sat-6-quality}
\caption{Quality plot of sequential planners on the seq-sat-6 dataset.}
\label{fig:tempo-sat-6-quality}
\end{subfigure}
\caption{Planner results on tempo-sat-6.}
\label{fig:tempo-sat-6-results}
\end{figure}


\subsection{Discussion}

In the updated results of the sequential satisficing track of IPC 2008\footnote{\url{http://icaps-conference.org/ipc2008/deterministic/Results.html}} published after the competition,
the overall winner \textit{LAMA} (a Fast Downward based planner)
was hands-down the best planner on the sequential Transport domain, winning
with a total quality of $28.93/30$, where all other planners had less than $20/30$.
Only 5 problem instances were solved suboptimally by \textit{LAMA}.

As mentioned, we were not able to gather data from the IPC 2011,
hence the results cannot be meaningfully interpreted.
The competition featured 20 sequential Transport problems,
with 4 planners achieving a total quality of more than $15/20$.

In the satisficing track of IPC 2014, the winner on the Transport domain
was without a doubt the \textit{Mercury} planner, achieving
a stunning $20/20$ total quality. Even more interesting is the fact that
the runner-up \textit{yahsp3-mt} achieved a score of $10.74/20$
and all other planners achieved sub $10/20$ total quality.
The IPC 2014 used different problem instances than the IPC 2008
and we have tested our approaches on both datasets.

\TODO{try to analyze why} \TODO{Vytiahnut si plany z vysledkov seq-sat08 z LAMA na seqsat ipc08 an z mercury a lama na ipc14 + analysis of specific errors and shortcommings}


\TODO{our results show that...}













\section{Temporal Transport}

In this section, we present the results of our temporal planners on the tempo-sat-6 dataset. The following planners are included in the experiment:
\begin{description}
\item[SFA*T] The SFA* algorithm with heuristic A, temporal version. \TODO{ref}
\item[OPT] The OptaPlanner temporal algorithm. \TODO{ref}
\end{description}

\subsection{Results}\label{temporal-results}

We show the IPC quality table
for an experimental run of these planners on the tempo-sat-6 dataset (Table~\ref{tab:tempo-sat-6-ipc-scores}).
Additionally, a plot of the scores and run times is presented in Figure~\ref{fig:tempo-sat-6-plots} and sample plan Gantt charts are shown in Figure~\ref{fig:tempo-sat-6-gantt}. The generated plans and benchmark results can be found in the \nameref{cd-contents}.

\begin{table}
\centering
\input{../data/tempo-sat-6-ipc-scores}
\caption{Quality and score of temporal planners on the tempo-sat-6 dataset.}
\label{tab:tempo-sat-6-ipc-scores}
\end{table}

\begin{figure}
\centering
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/tempo-sat-6-score}
\caption{Score plot of temporal planners on the tempo-sat-6 dataset.}
\label{fig:tempo-sat-6-score}
\end{subfigure}

\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/tempo-sat-6-runtime}
\caption{Run time plot of temporal planners on the tempo-sat-6 dataset.}
\label{fig:tempo-sat-6-runtime}
\end{subfigure}
\caption{Score and run time plots of temporal planners on the tempo-sat-6 dataset.}
\label{fig:tempo-sat-6-plots}
\end{figure}

\begin{figure}
\centering
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/tempo-sat-6-gantt-p15-A}
\caption{Gantt chart of the temporal planner \TODO{A} on the tempo-sat-6 \texttt{p15} problem.}
\label{fig:tempo-sat-6-gantt-15-a}
\end{subfigure}

\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=1.0\textwidth]{../imga/tempo-sat-6-gantt-p15-B}
\caption{Gantt chart of the temporal planner \TODO{B} on the tempo-sat-6 \texttt{p15} problem.}
\label{fig:tempo-sat-6-gantt-15-b}
\end{subfigure}
\caption{Gantt charts of the temporal planner \TODO{A and B} on the tempo-sat-6 \texttt{p15} problem.}
\label{fig:tempo-sat-6-gantt}
\end{figure}

\subsection{Discussion}

Planners that entered the 2008 temporal track at the IPC did not cope well with the Transport domain
--- only two non-baseline planners were able to produce at least one plan
for any problem. Additionally, only the simple problem (\verb+p01+) was solved
optimally by any planner. The best total quality was only $7.5/30$, achieved by
\textit{SGPlan$_6$}. No other domain in the temporal track had a lower best total quality
than Transport, which, assuming reasonably generated problem instances, hints
at Transport being one of the harder domains for domain-independent temporal planners.

\TODO{Vytiahnut si plany z vysledkov seq-sat08 TFD a sgplan6, najst deficiencies}

\TODO{discuss results}


\section{Overall results}

\TODO{intro + recap}